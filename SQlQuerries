import psycopg2

def store_feed(titles, descriptions, links, category, source):
    connection = psycopg2.connect(
        host="localhost",
        port="5432",
        dbname="newsag",
        user="postgres",
        password="1234"
    )
    cursor = connection.cursor()
    print("Database connected successfully")

    create_table = '''
    CREATE TABLE IF NOT EXISTS NewsArticles (
        id SERIAL PRIMARY KEY,
        Title VARCHAR(255) NOT NULL,
        Description TEXT,
        Source VARCHAR(225) NOT NULL,
        Catagory VARCHAR(225) NOT NULL,
        Link TEXT
    );
    '''
    cursor.execute(create_table)
    print("Table created successfully")

    insert_query = '''
    INSERT INTO NewsArticles (Title, Description, Source, Catagory, Link)
    VALUES (%s, %s, %s, %s, %s);
    '''

    for ti, de, li in zip(titles, descriptions, links):
        cursor.execute(insert_query, (ti, de, source, category, li))

    connection.commit()
    cursor.close()
    connection.close()
