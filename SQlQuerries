import psycopg2

host = "localhost"
port= "5432"
database= "test"
username= "postgres"
password= "BTW075"

class SQLQueries:

    def store_feed(title,description,source,category,news_links,pub_date):

        #CONNECTNG TO THE DATABASE
        connection = psycopg2.connect(host = host,
                              port = port,
                              dbname= database,
                              user= username,
                              password= password)
        
        #CREATING A CURSOR
        cursor = connection.cursor()
        Insertion = '''INSERT INTO test3 (title, description, source, category, link, pub_date)
                                    VALUES(%s, %s, %s, %s, %s, %s)'''    

        for ti , de, li, date in zip(title,description,news_links, pub_date):
            cursor.execute(Insertion, (ti, de, source, category, li, date))

        connection.commit()

        cursor.close()
        connection.close()
